<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Alumni</title>
<link rel="stylesheet" href="css/style.css">
</head>
<body>

<script src="https://cdn.jsdelivr.net/npm/@jaames/iro@5"></script>
<script src="/socket.io/socket.io.js"></script>

<div id="statusBarContainer">
    <div id="statusBarFill"></div>
    <div id="statusBarText">Actie</div>
</div>

<div id="footer">

  <div class="footer-left">
    <button id="adminBtn" title="Admin"><img src="icons/admin.png"></button>
    <button id="cheatBtn" title="Cheats"><img src="icons/cheat.png"></button>
    <div style="display:flex; gap:10px; align-items:center;">
        <button id="zoomOut" title="Zoom Out"><img src="icons/min.png"></button>
        <button id="centerCam" title="Center"><img src="icons/center.png"></button>
        <button id="zoomIn" title="Zoom In"><img src="icons/max.png"></button>
    </div>
    <button id="buildBtn" title="Bouwen"><img src="icons/buildmenu.png"></button>
    <button id="inventoryBtn" title="Inventaris"><img src="icons/inventory.png"></button>
  </div>

  <div class="chat-group">
    <input id="chatInput" type="text" placeholder="Typ hier je bericht..." />
    <div id="charCounter">0 / 80</div>
    <button id="openChatLog" title="Chat"><img src="icons/chat.png"></button>
    <button id="friendsBtn" title="Vrienden"><img src="icons/heart.png"></button>
    <button id="myRoomBtn" title="Mijn Kamer Instellingen"><img src="icons/myroom.png"></button>
    <button id="roomsBtn" title="Kamers"><img src="icons/rooms.png"></button>
  </div>

  <div class="footer-right">
    <img src="logo.png" alt="Logo" style="height: 24px; image-rendering:pixelated;">
  </div>

</div>

<div id="roleSelector">
  <h1 style="margin-bottom: 40px;">Kies je rol</h1>
  <div style="display:flex;">
      <button id="rolePlayerBtn" class="role-btn">Speler</button>
      <button id="roleAdminBtn" class="role-btn">Admin</button>
  </div>
</div>

<div id="buildMenu" style="display: none;">
  <div id="buildCategoryMenu">
    <button class="category-btn selected" data-category="objecten" title="Objecten"><img src="icons/object_active.png"></button>
    <button class="category-btn" data-category="kleur" title="Kleur"><img src="icons/color.png"></button>
    <button class="category-btn" id="adminRoomBtn" data-category="kamers" title="Kamers" style="display: none;"><img src="icons/new_room.png"></button>
    <button class="category-btn" id="adminWeatherBtn" data-category="weer" title="Weer" style="display: none;"><img src="icons/zon.png"></button>
  </div>

  <div id="buildMainContent">
    <div id="buildMenuHeader"> 
        <span>Bouwmodus</span> 
        <span class="close-btn" id="closeBuildMenuBtn">Ã—</span>
    </div>

    <!-- Weergave voor Objecten Categorie -->
    <div id="objectCategoryView" style="flex-direction: row;"> <!-- Aangepast voor sub-categorie menu -->
      <div id="objectSubCategoryMenu">
        <!-- Sub-categorie knoppen worden hier dynamisch toegevoegd -->
      </div>
      <div style="width: 100%; height: 100%;"> <!-- Wrapper voor tools en content -->
        <div id="buildTools">
          <div style="display: flex; gap: 5px; align-items: center;">
             <input type="text" id="buildSearchInput" placeholder="Zoek..." style="width: 70px; padding: 2px 4px; border-radius: 4px; border: 1px solid #555; background: #222; color: white; font-size: 11px;">
             <select id="buildSortSelect" style="width: 80px; padding: 2px; border-radius: 4px; border: 1px solid #555; background: #222; color: white; font-size: 11px;">
                <option value="name_asc">Naam A-Z</option>
                <option value="name_desc">Naam Z-A</option>
                <option value="price_asc">Prijs â†‘</option>
                <option value="price_desc">Prijs â†“</option>
             </select>
          </div>
          <div style="display: flex; gap: 10px;">
            <button id="moveToolBtn" class="tool-btn" title="Verplaatsen"><img src="icons/place.png"></button>
            <button id="deleteToolBtn" class="tool-btn" title="Verwijderen"><img src="icons/trash.png"></button>
            <button id="uploadToolBtn" class="tool-btn" title="Upload Custom Item" style="display:none;"><img src="icons/add.png"></button>
          </div>
        </div>
        <div id="buildMenuContent">
          <!-- Items worden hier dynamisch toegevoegd -->
        </div>
      </div>
    </div>

    <!-- Weergave voor Kleur Categorie -->
    <div id="colorCategoryView">
      <div id="colorTools">
        <button class="tool-btn selected" data-tool="brush" title="Kwast"><img src="icons/paint_active.png"></button> 
        <button class="tool-btn" data-tool="bucket" title="Verfemmer"><img src="icons/fill.png"></button>
        <button class="tool-btn" data-tool="picker" title="Pipet"><img src="icons/pipet.png"></button>
      </div>
      <div id="colorPickerWrapper">
        <div id="color-picker-container"></div>
        <div id="colorDetails">
          <div id="colorPreview"></div>
          <input type="text" id="hexInput" maxlength="7">
        </div>
      </div>
    </div>

    <!-- Weergave voor Kamers Categorie -->
    <div id="roomCategoryView" style="display: none; padding: 20px; color: white; font-family: Arial; flex-direction: column; gap: 15px; height: calc(100% - 36px); overflow-y: auto; box-sizing: border-box;">
        <h4 style="margin: 0 0 5px 0; font-weight: normal;">Kamer Aanmaken</h4>
        
        <div style="margin-bottom: 15px;">
            <input type="text" id="roomNameInput" placeholder="Naam" style="width: 50%; padding: 8px; background: #333; border: 1px solid #666; color: white; border-radius: 4px; font-size: 14px;">
        </div>

        <div style="margin-bottom: 15px; display: flex; align-items: center; gap: 5px;">
            <input type="number" id="roomWidthInput" placeholder="W" value="10" min="5" max="30" style="width: 40px; padding: 8px; background: #333; border: 1px solid #666; color: white; border-radius: 4px; font-size: 12px;" title="Breedte">
            <span style="font-size: 12px;">x</span>
            <input type="number" id="roomHeightInput" placeholder="H" value="10" min="5" max="30" style="width: 40px; padding: 8px; background: #333; border: 1px solid #666; color: white; border-radius: 4px; font-size: 12px;" title="Hoogte">
            <button id="resizeRoomBtn" style="padding: 8px; border: 1px solid #fff; background: transparent; color: white; cursor: pointer; border-radius: 4px; font-size: 10px; margin-left: 10px;" title="Pas grootte van huidige kamer aan">Resize Huidige</button>
        </div>

        <div style="margin-bottom: 10px; display: flex; align-items: center; gap: 20px; flex-wrap: wrap;">
            <!-- Always Online Toggle -->
            <div style="display:flex; align-items:center; gap:5px;">
                <span style="font-size:14px;">Online</span>
                <img id="adminAlwaysOnlineToggle" src="icons/rood.png" style="width:24px; height:24px; cursor:pointer;" title="Altijd Online">
            </div>
            
            <!-- Build Permission Toggle -->
            <div style="display:flex; align-items:center; gap:5px;">
                <span style="font-size:14px;">Bouwen</span>
                <img id="adminBuildToggle" src="icons/buildmenu_inactive.png" style="width:24px; height:24px; cursor:pointer;" title="Spelers mogen bouwen">
            </div>

            <!-- No Smoking Toggle -->
            <div style="display:flex; align-items:center; gap:5px;">
                <span style="font-size:14px;">Roken</span>
                <img id="adminNoSmokingToggle" src="icons/verboden.png" style="width:24px; height:24px; cursor:pointer;" title="Roken verboden">
            </div>

            <!-- Tile Numbers Toggle -->
            <div style="display:flex; align-items:center; gap:5px;">
                <span style="font-size:14px;">Nummers</span>
                <img id="adminTileNumbersToggle" src="icons/numbers.png" style="width:24px; height:24px; cursor:pointer;" title="Toon Tegel Nummers">
            </div>

            <!-- NIEUW: Outside Toggle -->
            <div style="display:flex; align-items:center; gap:5px;">
                <span style="font-size:14px;">Buiten</span>
                <img id="adminOutsideToggle" src="icons/zon.png" style="width:24px; height:24px; cursor:pointer;" title="Is Buitenruimte">
            </div>

            <script>
                // Inline script voor admin toggle logica
                const adminAlwaysOnlineToggle = document.getElementById('adminAlwaysOnlineToggle');
                adminAlwaysOnlineToggle.dataset.active = "false";
                adminAlwaysOnlineToggle.onclick = () => {
                    const current = adminAlwaysOnlineToggle.dataset.active === "true";
                    adminAlwaysOnlineToggle.dataset.active = !current;
                    adminAlwaysOnlineToggle.src = !current ? "icons/wit.png" : "icons/rood.png";
                };

                const adminBuildToggle = document.getElementById('adminBuildToggle');
                adminBuildToggle.dataset.allowed = "false";
                adminBuildToggle.onclick = () => {
                    const current = adminBuildToggle.dataset.allowed === "true";
                    adminBuildToggle.dataset.allowed = !current;
                    adminBuildToggle.src = !current ? "icons/buildmenu_active.png" : "icons/buildmenu_inactive.png";
                };

                const adminNoSmokingToggle = document.getElementById('adminNoSmokingToggle');
                adminNoSmokingToggle.dataset.forbidden = "false";
                adminNoSmokingToggle.onclick = () => {
                    const current = adminNoSmokingToggle.dataset.forbidden === "true";
                    adminNoSmokingToggle.dataset.forbidden = !current;
                    adminNoSmokingToggle.src = !current ? "icons/verboden_active.png" : "icons/verboden.png";
                };

                const adminOutsideToggle = document.getElementById('adminOutsideToggle');
                adminOutsideToggle.dataset.outside = "false";
                adminOutsideToggle.onclick = () => {
                    const current = adminOutsideToggle.dataset.outside === "true";
                    adminOutsideToggle.dataset.outside = !current;
                    adminOutsideToggle.src = !current ? "icons/zon_active.png" : "icons/zon.png";
                };
            </script>
        </div>

        <div style="display: flex; gap: 10px; margin-top: 10px; width: 100%;">
            <button id="createRoomBtn" style="flex: 1; padding: 10px 15px; border: white 1px solid; color: white; border-radius: 0px; cursor: pointer;">Aanmaken</button>
            <button id="saveRoomBtn" style="flex: 1; padding: 10px 15px; border: #7bff00 1px solid; color: #7bff00; border-radius: 0px; cursor: pointer;">Opslaan</button>
            <button id="clearRoomBtn" style="flex: 1; padding: 10px 15px; border: #f44336 1px solid; color: #f44336; border-radius: 0px; cursor: pointer;">Legen</button>
        </div>
        
        <div style="margin-top: 10px; width: 100%;">
             <button id="setSpawnBtn" style="width: 100%; padding: 10px 15px; border: 1px solid #4cd137; color: #4cd137; background: rgba(76, 209, 55, 0.1); cursor: pointer;">ðŸ“ Zet Spawn Op Mijn Positie</button>
        </div>

        <hr style="width: 100%; border: 0; border-top: 1px solid #555; margin: 10px 0;">
        <h4 style="margin: 0 0 5px 0; font-weight: normal;">Kamers</h4>
        <div id="roomList" style="flex-grow: 1; overflow-y: auto; background: rgba(0,0,0,0.2); border: 1px solid #444; padding: 5px; min-height: 100px;"></div>

    </div>

    <!-- Weergave voor Weer Categorie -->
    <div id="weatherCategoryView" style="display: none; padding: 20px; color: white; font-family: Arial; flex-direction: column; gap: 15px; height: calc(100% - 36px); overflow-y: auto; box-sizing: border-box;">
        <h4 style="margin: 0 0 5px 0; font-weight: normal;">Tijd</h4>
        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px;">
            <button class="time-btn" data-time="sunrise" title="Zonsopkomst" style="background: rgba(255,255,255,0.1); border: 1px solid #555; padding: 15px; border-radius: 8px; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 5px;">
                <span style="font-size: 24px;">ðŸŒ…</span>
                <span style="font-size: 12px; color: white;">Opkomst</span>
            </button>
            <button class="time-btn" data-time="day" title="Dag" style="background: rgba(255,255,255,0.1); border: 1px solid #555; padding: 15px; border-radius: 8px; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 5px;">
                <span style="font-size: 24px;">â˜€ï¸</span>
                <span style="font-size: 12px; color: white;">Dag</span>
            </button>
            <button class="time-btn" data-time="sunset" title="Zonsondergang" style="background: rgba(255,255,255,0.1); border: 1px solid #555; padding: 15px; border-radius: 8px; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 5px;">
                <span style="font-size: 24px;">ðŸŒ‡</span>
                <span style="font-size: 12px; color: white;">Ondergang</span>
            </button>
            <button class="time-btn" data-time="night" title="Nacht" style="background: rgba(255,255,255,0.1); border: 1px solid #555; padding: 15px; border-radius: 8px; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 5px;">
                <span style="font-size: 24px;">ðŸŒ™</span>
                <span style="font-size: 12px; color: white;">Nacht</span>
            </button>
        </div>

        <h4 style="margin: 0 0 5px 0; font-weight: normal;">Weer</h4>
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
            <button class="weather-btn" data-weather="clear" title="Helder" style="background: rgba(255,255,255,0.1); border: 1px solid #555; padding: 15px; border-radius: 8px; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 5px;">
                <span style="font-size: 24px;">â˜ï¸</span>
                <span style="font-size: 12px; color: white;">Helder</span>
            </button>
            <button class="weather-btn" data-weather="rain" title="Regen" style="background: rgba(255,255,255,0.1); border: 1px solid #555; padding: 15px; border-radius: 8px; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 5px;">
                <span style="font-size: 24px;">ðŸŒ§ï¸</span>
                <span style="font-size: 12px; color: white;">Regen</span>
            </button>
            <button class="weather-btn" data-weather="snow" title="Sneeuw" style="background: rgba(255,255,255,0.1); border: 1px solid #555; padding: 15px; border-radius: 8px; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 5px;">
                <span style="font-size: 24px;">â„ï¸</span>
                <span style="font-size: 12px; color: white;">Sneeuw</span>
            </button>
            <button class="weather-btn" data-weather="mist" title="Mist" style="background: rgba(255,255,255,0.1); border: 1px solid #555; padding: 15px; border-radius: 8px; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 5px;">
                <span style="font-size: 24px;">ðŸŒ«ï¸</span>
                <span style="font-size: 12px; color: white;">Mist</span>
            </button>
            <button class="weather-btn" data-weather="sun" title="Zon (Gloed)" style="background: rgba(255,255,255,0.1); border: 1px solid #555; padding: 15px; border-radius: 8px; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 5px;">
                <span style="font-size: 24px;">ðŸŒ…</span>
                <span style="font-size: 12px; color: white;">Zon</span>
            </button>
        </div>

        <hr style="width: 100%; border: 0; border-top: 1px solid #555; margin: 20px 0;">
        <div style="display:flex; align-items:center; justify-content:space-between;">
            <span style="font-size:14px;">Live Server Sync</span>
            <img id="adminRealTimeToggle" src="icons/rood.png" style="width:24px; height:24px; cursor:pointer;" title="Sync met echte tijd en weer van server locatie">
        </div>
    </div>
  </div>
</div>

<div id="chatLog">
  <div id="chatLogHeader">
    <span>Chat geschiedenis</span>
    <span class="close-btn" id="closeChatLogBtn">Ã—</span>
  </div>
  <div id="chatLogContent"></div>
</div>

<div id="uploadModal">
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <h4 style="margin:0;">Object Uploaden</h4>
        <span id="closeUploadModalCross" style="cursor:pointer; font-size:24px; line-height:1;">Ã—</span>
    </div>
    
    <input type="text" id="customObjectName" placeholder="Naam van object (optioneel)" maxlength="20">
    <input type="number" id="customObjectPrice" placeholder="Prijs (optioneel)" style="width: 100%; padding: 8px; background: #333; border: 1px solid #555; color: white; font-family: Arial, sans-serif; font-size: 14px; border-radius: 4px; box-sizing: border-box; margin-top: 10px;">
    <input type="text" id="customObjectKeywords" placeholder="Trefwoorden (komma gescheiden)" style="width: 100%; padding: 8px; background: #333; border: 1px solid #555; color: white; font-family: Arial, sans-serif; font-size: 14px; border-radius: 4px; box-sizing: border-box; margin-top: 10px;">
    
    <div style="margin-top: 10px; display: flex; align-items: center; gap: 10px;">
        <input type="checkbox" id="customObjectAdminOnly">
        <label for="customObjectAdminOnly" style="font-size: 14px;">Alleen voor Admins</label>
    </div>

    <div style="margin-top: 10px;">
        <label style="font-size:14px; color:#ccc; display:block; margin-bottom:5px;">Functie Template:</label>
        <select id="templateSelect" style="width: 100%; padding: 8px; background: #333; border: 1px solid #555; color: white; border-radius: 4px; font-family: Arial;"></select>
    </div>
    
    <!-- NIEUW: Configuratie stap na bestandselectie -->
    <div id="uploadConfigStep" style="display:none; flex-direction:column; gap:10px; margin-top:10px; border-top:1px solid #555; padding-top:10px;">
        <div style="display:flex; flex-direction:row; align-items:flex-start; gap:10px;">
            <!-- Canvas voor visuele collision editor -->
            <div style="position:relative; border:1px solid #555; background:rgba(0,0,0,0.3); border-radius:4px; max-height: 220px; max-width: 220px; overflow: auto; flex-shrink: 0;">
                <canvas id="collisionCanvas" width="128" height="128" style="display:block; cursor:nwse-resize; image-rendering:pixelated;"></canvas>
            </div>
            
            <!-- Inputs rechts onder elkaar -->
            <div style="display:flex; flex-direction:column; gap:8px; flex-grow:1;">
                <div>
                    <label style="font-size:10px; color:#aaa; display:block;">Breedte (X)</label>
                    <input type="number" id="confWidth" class="popup-input" style="width:100%; margin:0; padding:4px; text-align:left;" min="1" value="1">
                </div>
                <div>
                    <label style="font-size:10px; color:#aaa; display:block;">Diepte (Y)</label>
                    <input type="number" id="confDepth" class="popup-input" style="width:100%; margin:0; padding:4px; text-align:left;" min="1" value="1">
                </div>
                <div>
                    <label style="font-size:10px; color:#aaa; display:block;">Hoogte (Z)</label>
                    <input type="number" id="confHeight" class="popup-input" style="width:100%; margin:0; padding:4px; text-align:left;" min="1" value="1">
                </div>
            </div>
        </div>
        <div style="display:flex; gap:15px; margin-top:5px; justify-content:center;">
            <label style="display:flex; align-items:center; gap:5px; font-size:12px; cursor:pointer;">
                <input type="checkbox" id="confWalkable"> Beloopbaar (Vloer)
            </label>
            <label style="display:flex; align-items:center; gap:5px; font-size:12px; cursor:pointer;">
                <input type="checkbox" id="confMoveable"> Verplaatsbaar (Rigidbody)
            </label>
        </div>
        <div style="display:flex; gap:10px; margin-top:10px;">
            <button id="doUploadBtn" class="popup-btn confirm" style="flex:1; padding:10px;">Bevestigen & Uploaden</button>
            <button id="cancelConfigBtn" class="popup-btn deny" style="flex:1; padding:10px;">Terug</button>
        </div>
    </div>

        <input type="file" id="customFileUpload" style="display:none;" accept="image/*">
</div>

<div id="inventory" style="display: none;">
  <div id="inventoryHeader">
    <span>Inventaris</span>
    <span class="close-btn" id="closeInventoryBtn">Ã—</span>
  </div>
  <div id="inventoryTools">
    <div style="display: flex; align-items: center; gap: 8px;">
      <div id="wallet">â‚¬0.00</div>
      <div id="transactionFeed"></div>
    </div>
    <div style="display: flex; gap: 10px;">
      <button id="paperBtn" class="tool-btn" title="Papier"><img src="icons/paper.png"></button>
      <button id="markerBtn" class="tool-btn" title="Marker"><img src="icons/marker.png"></button>
      <button id="vicinityBtn" class="tool-btn" title="Omgeving"><img src="icons/vicinity.png"></button>
    </div>
  </div>
  <div id="inventoryContent">
    <!-- Inventaris items komen hier -->
  </div>
</div>

<div id="vicinityWindow">
  <div id="vicinityHeader">
    <span>Omgeving</span>
    <span class="close-btn" id="closeVicinityWindowBtn">Ã—</span>
  </div>
  <div id="vicinityContent" style="padding: 10px; overflow-y: auto; height: calc(100% - 36px); display: grid; grid-template-columns: repeat(auto-fill, minmax(64px, 1fr)); gap: 10px; padding-bottom: 20px; align-content: start;"></div>
</div>

<div id="paperWindow">
  <div id="paperHeader">
    <span>Projecten</span>
    <span class="close-btn" id="closePaperBtn">Ã—</span>
  </div>
  <div id="paperContent">
    <div class="paper-grid" id="paperGrid">
      <!-- Wordt gevuld door JS -->
    </div>
  </div>
</div>

<div id="projectWindow">
  <div id="projectHeader">
    <div style="display: flex; align-items: center; gap: 20px;">
        <span id="projectTitle" style="font-weight: bold;">Project</span>
        <div style="display: flex; gap: 5px;">
            <div style="position: relative;">
                <button class="project-menu-btn" id="projFileBtn">Bestand</button>
                <div id="projFileDropdown" class="project-dropdown">
                    <div class="dropdown-item" id="projSaveBtn">Opslaan</div>
                    <div class="dropdown-item" id="projExportBtn">Exporteren</div>
                </div>
            </div>
            <button class="project-menu-btn" id="projSettingsBtn">Instellingen</button>
            <button class="project-menu-btn" id="projInsertBtn">Invoegen</button>
        </div>
    </div>
    <span class="close-btn" id="closeProjectBtn">Ã—</span>
  </div>
  <div id="projectSubHeader"></div>
  <div id="projectMainLayout">
    <div id="projectToolbar">
      <div id="projectToolbarHeader">Tools</div>
      <button class="tool-btn" id="projToolTransform" title="Transformeren (Cmd+T)">ðŸ“</button>
      <button class="tool-btn" id="projToolHand" title="Hand">âœ‹</button>
      <button class="tool-btn" id="projToolSelect" title="Selectie">â¬š</button>
      <button class="tool-btn" id="projToolBrush" title="Brush">ðŸ–Œï¸</button>
      <button class="tool-btn" id="projToolEraser" title="Gum">ðŸ§¼</button>
      <button class="tool-btn" id="projToolText" title="Tekst">T</button>
      <button class="tool-btn" id="projToolPicker" title="Kleurkiezer">ðŸ§ª</button>
    </div>
    <div id="projectWorkspace">
      <div id="projectCanvasWrapper">
          <div id="projectClippingMask"></div>
          <div id="transformOverlay">
              <div class="transform-anchor" id="transformAnchor"></div>
              <div class="transform-rotator" id="transformRotator"></div>
              <div class="transform-handle" data-dir="nw" style="top:-4px; left:-4px; cursor:nwse-resize;"></div>
              <div class="transform-handle" data-dir="n"  style="top:-4px; left:50%; margin-left:-4px; cursor:ns-resize;"></div>
              <div class="transform-handle" data-dir="ne" style="top:-4px; right:-4px; cursor:nesw-resize;"></div>
              <div class="transform-handle" data-dir="e"  style="top:50%; right:-4px; margin-top:-4px; cursor:ew-resize;"></div>
              <div class="transform-handle" data-dir="se" style="bottom:-4px; right:-4px; cursor:nwse-resize;"></div>
              <div class="transform-handle" data-dir="s"  style="bottom:-4px; left:50%; margin-left:-4px; cursor:ns-resize;"></div>
              <div class="transform-handle" data-dir="sw" style="bottom:-4px; left:-4px; cursor:nesw-resize;"></div>
              <div class="transform-handle" data-dir="w"  style="top:50%; left:-4px; margin-top:-4px; cursor:ew-resize;"></div>
          </div>
          <div id="projectSelectionOverlay"></div>
      </div>
      <div id="projectZoomLevel">100%</div>
    </div>
    <div id="projectSidebar">
      <div id="projectColorPanel">
        <div class="project-panel-header">ðŸŽ¨ Kleur</div>
        <div id="project-color-picker-container"></div>
      </div>
      <div id="projectLayersPanel">
        <div class="project-panel-header">ðŸ“š Lagen</div>
        <div id="projectLayersList"></div>
        <div style="display: flex; gap: 5px; margin-top: 10px; justify-content: center;">
            <button id="addLayerBtn" class="tool-btn" title="Nieuwe Laag" style="border: 1px solid #555; border-radius: 4px;">âž•</button>
            <button id="deleteLayerBtn" class="tool-btn" title="Verwijder Laag" style="border: 1px solid #555; border-radius: 4px;">ðŸ—‘ï¸</button>
        </div>
      </div>
    </div>
  </div>
</div>

<input type="file" id="projInsertInput" accept="image/*" style="display: none;">

<div id="projectSettingsModal" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(17, 17, 17, 0.95); border: 1px solid white; padding: 20px; border-radius: 10px; z-index: 200; color: white; font-family: Arial, sans-serif; width: 250px; flex-direction: column; gap: 15px;">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 10px;">
        <h4 style="margin:0;">Instellingen</h4>
        <span id="closeProjSettings" style="cursor:pointer; font-size:20px;">Ã—</span>
    </div>
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <label>Hulplijnen</label>
        <input type="color" id="setGuideColor" value="#7bff00" style="cursor:pointer;">
    </div>
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <label>Transformatie</label>
        <input type="color" id="setTransformColor" value="#7bff00" style="cursor:pointer;">
    </div>
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <label>Middenpunt</label>
        <input type="color" id="setAnchorColor" value="#7bff00" style="cursor:pointer;">
    </div>
</div>

<div id="newProjectWindow">
  <div id="newProjectHeader">
    <span>Nieuw Project</span>
    <span class="close-btn" id="closeNewProjectWindowBtn">Ã—</span>
  </div>
  <div id="newProjectContent">
    <div style="display: flex; height: 100%; gap: 20px;">
      <!-- Linker kolom: Preview -->
      <div style="flex: 1.5; background: rgba(0,0,0,0.2); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; display: flex; align-items: center; justify-content: center; position: relative; overflow: hidden;">
          <div id="projectPreviewCanvas" style="background: white; width: 80px; height: 60px; transition: all 0.3s; border: 1px solid #999;"></div>
          <span id="projectPreviewDimensions" style="position: absolute; bottom: 10px; right: 10px; font-size: 10px; color: #aaa;">800 x 600</span>
      </div>

      <!-- Rechter kolom: Instellingen -->
      <div style="flex: 1; display: flex; flex-direction: column; gap: 15px; color: white; font-family: Arial, sans-serif;">
        
        <!-- Project Naam -->
        <div style="display: flex; flex-direction: column; gap: 5px;">
          <label style="font-size: 10px; color: #aaa;">Projectnaam</label>
          <input type="text" id="newProjectName" value="naamloos_project" style="background: transparent; border: none; border-bottom: 1px solid rgba(255,255,255,0.5); color: white; font-size: 10px; padding: 8px 0; outline: none; width: 100%; font-family: Arial, sans-serif;">
        </div>

        <!-- Afmetingen -->
        <div style="display: flex; gap: 15px; align-items: flex-end;">
          <div style="display: flex; flex-direction: column; gap: 5px; flex: 1;">
            <label style="font-size: 10px; color: #aaa;">Breedte</label>
            <input type="number" id="newProjectWidth" value="800" style="background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: white; padding: 8px; border-radius: 4px; width: 100%; font-family: Arial, sans-serif; font-size: 10px; box-sizing: border-box;">
          </div>
          <div style="display: flex; flex-direction: column; gap: 5px; flex: 1;">
            <label style="font-size: 10px; color: #aaa;">Hoogte</label>
            <input type="number" id="newProjectHeight" value="600" style="background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: white; padding: 8px; border-radius: 4px; width: 100%; font-family: Arial, sans-serif; font-size: 10px; box-sizing: border-box;">
          </div>
        </div>

        <!-- Looprichting -->
        <div style="display: flex; flex-direction: column; gap: 5px;">
          <label style="font-size: 10px; color: #aaa;">Looprichting</label>
          <select id="newProjectOrientation" style="background: #222; border: 1px solid rgba(255,255,255,0.2); color: white; padding: 8px; border-radius: 4px; width: 100%; font-family: Arial, sans-serif; font-size: 10px; cursor: pointer; box-sizing: border-box;">
            <option value="horizontal">Horizontaal</option>
            <option value="vertical">Verticaal</option>
          </select>
        </div>

        <!-- Achtergrond -->
        <div style="display: flex; flex-direction: column; gap: 5px;">
          <label style="font-size: 10px; color: #aaa;">Achtergrond</label>
          <select id="newProjectBackground" style="background: #222; border: 1px solid rgba(255,255,255,0.2); color: white; padding: 8px; border-radius: 4px; width: 100%; font-family: Arial, sans-serif; font-size: 10px; cursor: pointer; box-sizing: border-box;">
            <option value="white">Wit</option>
            <option value="black">Zwart</option>
            <option value="transparent">Transparant</option>
          </select>
        </div>

        <!-- Voorinstellingen -->
        <div style="display: flex; flex-direction: column; gap: 5px;">
          <label style="font-size: 10px; color: #aaa;">Voorinstellingen</label>
          <select id="newProjectPresets" style="background: #222; border: 1px solid rgba(255,255,255,0.2); color: white; padding: 8px; border-radius: 4px; width: 100%; font-family: Arial, sans-serif; font-size: 10px; cursor: pointer; box-sizing: border-box;">
            <option value="">-- Selecteer --</option>
          </select>
        </div>

        <div style="flex: 1;"></div>

        <div style="display: flex; flex-direction: column; gap: 10px;">
            <button id="saveProjectSettingsBtn">Instellingen opslaan</button>
            <button id="createNewProjectConfirmBtn">Project Aanmaken</button>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="colorSelectionWindow">
  <div style="padding: 20px; display: flex; justify-content: center;">
      <div id="text-color-picker-container"></div>
  </div>
  <div style="padding: 10px; display: flex; justify-content: center; gap: 10px; border-top: 1px solid rgba(255,255,255,0.2);">
      <button id="confirmColorBtn" class="popup-btn confirm">Bevestigen</button>
      <button id="cancelColorBtn" class="popup-btn deny">Annuleren</button>
  </div>
</div>

<div id="markerMenu">
  <div id="markerMenuHeader">
    <span>Marker</span>
    <span class="close-btn" id="closeMarkerMenuBtn">Ã—</span>
  </div>
  <div id="markerTools" style="padding: 5px 10px; display: flex; gap: 10px; justify-content: center; align-items: center; background: rgba(0,0,0,0.1); border-bottom: 1px solid rgba(255, 255, 255, 0.2);">
      <button id="markerToolDraw" class="tool-btn" title="Tekenen"><img src="icons/marker_active.png"></button>
      <button id="markerToolErase" class="tool-btn" title="Gummen"><img src="icons/eraser.png"></button>
  </div>
  <div style="padding: 10px; border-bottom: 1px solid rgba(255, 255, 255, 0.2); background: rgba(0,0,0,0.1); display: flex; flex-direction: column; align-items: center;">
      <div style="display: flex; justify-content: space-between; width: 130px; font-size: 10px; color: #ccc; margin-bottom: 2px; padding: 0 2px;">
          <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span><span>6</span>
      </div>
      <div style="display: flex; align-items: center; gap: 5px;">
          <input type="range" id="markerSizeSlider" min="1" max="6" step="1" value="2" style="width: 130px; cursor: pointer;">
      </div>
  </div>
  <div style="padding: 20px; display: flex; flex-direction: column; align-items: center; gap: 15px;">
      <div id="marker-color-picker-container"></div>
      <div style="display:flex; gap:10px; align-items:center;">
          <div id="markerColorPreview" style="width:30px; height:30px; border:1px solid white; border-radius:4px; background-color:#000;"></div>
          <input type="text" id="markerHexInput" value="#000000" style="width:70px; padding:5px; background:#222; border:1px solid #555; color:white; border-radius:4px; font-family:monospace;">
      </div>
  </div>
</div>

<div id="movePreview" style="display: none; position: absolute; top: 0; left: 0; pointer-events: none; z-index: 10000; background: rgba(0, 0, 0, 0.85); border: 1px solid rgba(255, 255, 255, 0.5); padding: 10px; border-radius: 8px; color: white; font-family: Arial, sans-serif; font-size: 12px; align-items: center; gap: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.5); backdrop-filter: blur(4px);">
    <div style="width: 48px; height: 48px; display: flex; align-items: center; justify-content: center; border-radius: 4px;">
        <img id="movePreviewImg" src="" style="max-width: 100%; max-height: 100%; object-fit: contain; image-rendering: pixelated;">
    </div>
    <div style="display: flex; flex-direction: column; gap: 2px;">
        <span id="movePreviewName" style="font-size: 10px; text-shadow: 1px 1px 0 #000;"></span>
        <span id="movePreviewActionText" style="color: #ccc; font-size: 10px; font-style: italic;">Verplaatsen</span>
        <span id="movePreviewPrice" style="display:none; color: #7bff00; font-size: 10px;"></span>
        <span id="movePreviewCount" style="display:none; color: #aaa; font-size: 10px; margin-top: 2px;"></span>
    </div>
</div>

<div id="pongBackdrop"></div>

<div id="notification"></div>
<div id="voteCounter"></div>

<div id="shopWindow">
  <div id="shopHeader">
    <span>Winkel</span>
    <span class="close-btn" id="closeShopBtn">Ã—</span>
  </div>
  <div id="shopTools" style="padding: 10px; background: rgba(0,0,0,0.2); border-bottom: 1px solid rgba(255,255,255,0.1); display: flex; flex-direction: column; gap: 8px;">
      <input type="text" id="shopSearchInput" placeholder="Zoeken..." style="padding: 6px; border-radius: 4px; border: 1px solid #555; background: #222; color: white; font-family: Arial, sans-serif; font-size: 12px;">
      <select id="shopSortSelect" style="padding: 6px; border-radius: 4px; border: 1px solid #555; background: #222; color: white; font-family: Arial, sans-serif; font-size: 12px;">
          <option value="name_asc">Naam (A-Z)</option>
          <option value="name_desc">Naam (Z-A)</option>
          <option value="price_asc">Prijs (Laag - Hoog)</option>
          <option value="price_desc">Prijs (Hoog - Laag)</option>
      </select>
  </div>
  <div id="shopContent"></div>
  <div id="shopOutput"></div>
</div>

<div id="roomsWindow">
  <div id="roomsHeader" class="window-header" style="height: 36px; line-height: 36px; padding: 0 12px; background: #1a1a1a; border-bottom: 1px solid rgba(255, 255, 255, 0.2); border-radius: 10px 10px 0 0; cursor: move; user-select: none; display: flex; justify-content: space-between; align-items: center;">
    <span>Kamers</span>
    <span class="close-btn" id="closeRoomsBtn">Ã—</span>
  </div>
  <div style="padding: 5px 10px; border-bottom: 1px solid #444; background: rgba(0,0,0,0.2);">
      <select id="roomSortSelect" style="width: 100%; background: #333; color: white; border: 1px solid #555; padding: 4px; border-radius: 50px; font-size: 10px;">
          <option value="friends">Sorteren op: Vrienden</option>
          <option value="busy">Sorteren op: Druk</option>
          <option value="quiet">Sorteren op: Rustig</option>
      </select>
  </div>
  <div id="roomsContent"></div>
</div>

<div id="myRoomWindow">
  <div id="myRoomHeader" class="window-header" style="height: 36px; line-height: 36px; padding: 0 12px; background: #1a1a1a; border-bottom: 1px solid rgba(255, 255, 255, 0.2); border-radius: 10px 10px 0 0; cursor: move; user-select: none; display: flex; justify-content: space-between; align-items: center;">
    <span>Mijn Studio</span>
    <span class="close-btn" id="closeMyRoomBtn">Ã—</span>
  </div>
  <div id="myRoomContent"></div>
</div>

<div id="roomPlayersWindow">
  <div id="roomPlayersHeader" class="window-header" style="height: 36px; line-height: 36px; padding: 0 12px; background: #1a1a1a; border-bottom: 1px solid rgba(255, 255, 255, 0.2); border-radius: 10px 10px 0 0; cursor: move; user-select: none; display: flex; justify-content: space-between; align-items: center; font-size: 14px;">
    <span>Spelers in Kamer</span>
    <span class="close-btn" id="closeRoomPlayersBtn">Ã—</span>
  </div>
  <div id="roomPlayersContent" style="overflow-y: auto; height: calc(100% - 36px);"></div>
</div>

<div id="friendsWindow">
  <div id="friendsHeader" class="window-header" style="height: 36px; line-height: 36px; padding: 0 12px; background: #1a1a1a; border-bottom: 1px solid rgba(255, 255, 255, 0.2); border-radius: 10px 10px 0 0; cursor: move; user-select: none; display: flex; justify-content: space-between; align-items: center;">
    <span>Vrienden</span>
    <span class="close-btn" id="closeFriendsBtn">Ã—</span>
  </div>
  <div id="friendsContent" style="overflow-y: auto; height: calc(100% - 36px);"></div>
</div>

<div id="containerWindow">
  <div id="containerHeader">
    <span>Container</span>
    <span class="close-btn" id="closeContainerBtn">Ã—</span>
  </div>
  <div id="containerTools" style="display: none;"></div>
  <div id="containerContent" style="position: relative; height: calc(100% - 36px); overflow: hidden;"></div>
</div>

<!-- NIEUW: Pouch Venster (voor items in inventory) -->
<div id="pouchWindow">
  <div id="pouchHeader" class="window-header">
    <span>Pouch</span>
    <span class="close-btn" id="closePouchBtn">Ã—</span>
  </div>
  <div id="pouchContent" style="position: relative; height: calc(100% - 36px); overflow: hidden;"></div>
</div>

<!-- NIEUW: Context Menu voor Inventory Items -->
<div id="itemContextMenu" style="display: none; position: absolute; z-index: 2000; background: rgba(17, 17, 17, 0.95); border: 1px solid white; border-radius: 4px; min-width: 100px; box-shadow: 0 4px 6px rgba(0,0,0,0.3);">
    <div id="ctxOpenBtn" class="ctx-item" style="padding: 8px 12px; cursor: pointer; color: white; font-family: Arial; font-size: 12px; border-bottom: 1px solid #444;">Openen</div>
    <div id="ctxCancelBtn" class="ctx-item" style="padding: 8px 12px; cursor: pointer; color: #aaa; font-family: Arial; font-size: 12px;">Annuleren</div>
</div>

<div id="pongGame">
  <div id="pongHeader"> <!-- Uniek ID voor slepen -->
    <span>Tafeltennis</span>
    <span class="close-btn" id="closePongBtn">Ã—</span>
  </div>
  <div id="pongScoreboard">
    <div class="score-player"><span id="playerNameLabel">Speler</span>: <span id="playerScore">0</span></div>
    <div class="score-ai"><span id="opponentNameLabel">Tegenstander</span>: <span id="aiScore">0</span></div>
  </div>
  <canvas id="pongCanvas" width="600" height="264"></canvas>
</div>

<canvas id="canvas"></canvas>

<script src="js/game.js"></script>
</body>
</html>
